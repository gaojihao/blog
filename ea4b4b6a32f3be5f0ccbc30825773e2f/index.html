<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <title>22 使用映射类型得到新的类型 | lizhi1026.top</title><meta name="description" content="大前端知识分享网站">
    <link rel="preload" href="/assets/js/runtime~app.56da2130.js" as="script"><link rel="preload" href="/assets/css/styles.25f7fced.css" as="style"><link rel="preload" href="/assets/js/4666.93202135.js" as="script"><link rel="preload" href="/assets/js/app.942499dd.js" as="script"><link rel="prefetch" href="/assets/js/v-06800a30.f3dec077.js"><link rel="prefetch" href="/assets/js/v-0cec149c.bfb69549.js"><link rel="prefetch" href="/assets/js/v-7bf71e2f.445f559d.js"><link rel="prefetch" href="/assets/js/v-afcf349c.83e92e33.js"><link rel="prefetch" href="/assets/js/5830.c7d14f1b.js"><link rel="prefetch" href="/assets/js/v-41360372.686f3b5e.js"><link rel="prefetch" href="/assets/js/v-66c1598a.a282d5dd.js"><link rel="prefetch" href="/assets/js/v-26ed9ad3.92bb18be.js"><link rel="prefetch" href="/assets/js/v-0f53152a.d26dfc64.js"><link rel="prefetch" href="/assets/js/v-50d82b15.91ee28e4.js"><link rel="prefetch" href="/assets/js/v-dff859fc.f557570b.js"><link rel="prefetch" href="/assets/js/v-18509685.df423604.js"><link rel="prefetch" href="/assets/js/v-a922edc0.535a94a4.js"><link rel="prefetch" href="/assets/js/v-1d4c7ec0.cf60d8dd.js"><link rel="prefetch" href="/assets/js/v-77d53053.0a341438.js"><link rel="prefetch" href="/assets/js/v-d6494774.fc802c43.js"><link rel="prefetch" href="/assets/js/v-44577b2c.90b3dab6.js"><link rel="prefetch" href="/assets/js/v-60cb68ec.2b811fdb.js"><link rel="prefetch" href="/assets/js/v-6a8aaabc.b69ccc84.js"><link rel="prefetch" href="/assets/js/v-1d247778.1f704f62.js"><link rel="prefetch" href="/assets/js/v-eec6bdf2.9dfc99e5.js"><link rel="prefetch" href="/assets/js/v-5e3003f2.0480b37f.js"><link rel="prefetch" href="/assets/js/8079.c3bbc0d7.js"><link rel="prefetch" href="/assets/js/v-690d1ccf.210a0aaa.js"><link rel="prefetch" href="/assets/js/v-4eab4074.98636d52.js"><link rel="prefetch" href="/assets/js/v-226a117c.df5ea4f3.js"><link rel="prefetch" href="/assets/js/v-0dd0ed5c.48c3e5f6.js"><link rel="prefetch" href="/assets/js/v-2dc80c78.aebbc661.js"><link rel="prefetch" href="/assets/js/v-06ce03a3.393915e8.js"><link rel="prefetch" href="/assets/js/v-255f3c16.7dda2681.js"><link rel="prefetch" href="/assets/js/v-2acb2440.318dbfe2.js"><link rel="prefetch" href="/assets/js/v-5f1d9e81.908f219f.js"><link rel="prefetch" href="/assets/js/v-6ad26784.75e47cd3.js"><link rel="prefetch" href="/assets/js/v-01580f52.1b9475e7.js"><link rel="prefetch" href="/assets/js/v-1c4caef2.8e2d2a6d.js"><link rel="prefetch" href="/assets/js/v-5272b55f.d31a06ca.js"><link rel="prefetch" href="/assets/js/v-3e21a9cc.2bfdcc89.js"><link rel="prefetch" href="/assets/js/v-9f22f4ae.70636cc8.js"><link rel="prefetch" href="/assets/js/v-c95b0bb0.0c2e9386.js"><link rel="prefetch" href="/assets/js/v-3501e2d3.682a91f5.js"><link rel="prefetch" href="/assets/js/v-43870b30.c12b71f5.js"><link rel="prefetch" href="/assets/js/v-3e9755d6.7e26e47a.js"><link rel="prefetch" href="/assets/js/v-66d50acf.33f4a2d3.js"><link rel="prefetch" href="/assets/js/v-adc3e5f2.854489e9.js"><link rel="prefetch" href="/assets/js/v-26cdd7e2.e81a97c9.js"><link rel="prefetch" href="/assets/js/v-6d3cecb0.57f3cc41.js"><link rel="prefetch" href="/assets/js/v-7022f99e.9f5d8567.js"><link rel="prefetch" href="/assets/js/v-5953ceb8.e0f46831.js"><link rel="prefetch" href="/assets/js/v-24f73c0c.a3cec53b.js"><link rel="prefetch" href="/assets/js/v-222dd469.f2d22200.js"><link rel="prefetch" href="/assets/js/7534.7858fa5b.js"><link rel="prefetch" href="/assets/js/9330.a24ae1ea.js"><link rel="prefetch" href="/assets/js/v-52e63bcd.e76b3be6.js"><link rel="prefetch" href="/assets/js/v-ee220b6c.316962c1.js"><link rel="prefetch" href="/assets/js/1493.621b4732.js"><link rel="prefetch" href="/assets/js/v-42a882a6.e9bdd474.js"><link rel="prefetch" href="/assets/js/2872.274d6544.js"><link rel="prefetch" href="/assets/js/8427.53575c78.js"><link rel="prefetch" href="/assets/js/3238.c15e0c51.js"><link rel="prefetch" href="/assets/js/9163.9349bcf1.js"><link rel="prefetch" href="/assets/js/7042.9829b4c6.js"><link rel="prefetch" href="/assets/js/2994.73b50e07.js"><link rel="prefetch" href="/assets/js/v-09516126.809b320d.js"><link rel="prefetch" href="/assets/js/v-8daa1a0e.6f16aea4.js"><link rel="prefetch" href="/assets/js/v-1152bc8b.99b5d6fd.js"><link rel="prefetch" href="/assets/js/v-e355b60c.b46b7823.js"><link rel="prefetch" href="/assets/js/v-41507b24.e30e8d98.js"><link rel="prefetch" href="/assets/js/v-15534fdd.605934fb.js"><link rel="prefetch" href="/assets/js/v-3706649a.10e6f071.js"><link rel="prefetch" href="/assets/css/6286.styles.2808748c.css">
    <link rel="stylesheet" href="/assets/css/styles.25f7fced.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><header class="theme-header" is-logo="true"><a href="/" class="logo-link" style=""><img src="/images/logo-light.svg" alt class="logo"><strong class="title">lizhi1026.top</strong></a><!----><nav class="navbar"><i class="iconfont icon-menu menu-btn"></i><ul class="nav-list"><li class="nav-item"><div class="navbar-blogger"><div class="avatar"><img src="/images/avatar.jpg" alt="头像" title="头像"></div><div class="types"><a href="/categories/?category=all" class="type"><span class="text">分类</span><span class="num">52</span></a><div class="divider"></div><a href="/tags/?tag=all" class="type"><span class="text">标签</span><span class="num">52</span></a></div><div class="blogger"><div class="name">前端程序猿</div><p class="slogan" title="种一棵树最好的时间是十年前，其次是现在！">种一棵树最好的时间是十年前，其次是现在！</p></div></div></li><!--[--><li class="nav-link nav-item"><a href="/PostsLayout" class="navbar-item"><!----><span class="text">TypeScript学习笔记</span></a></li><li class="nav-link nav-item"><a href="/PostsLayout" class="navbar-item"><!----><span class="text">深入理解JavaScript</span></a></li><!--]--><li class="nav-link nav-item"><button class="theme-toggle"><i class="icon-sun iconfont"></i></button></li><li class="nav-link nav-item search-link"><a href="/search/" class="navbar-item"><i class="icon-search iconfont"></i><span class="text">搜索</span></a></li><li class="nav-item nav-medias"><div class="medias"><!--[--><a class="icon-email iconfont" href="lizhi1026@126.com" title="email" target="_blank"></a><a class="icon-github iconfont" href="https://github.com/gaojihao" title="github" target="_blank"></a><!--]--></div></li></ul></nav></header><!--[--><main class="theme-container theme-post-container"><aside class="post-aside"><ul class="menu-list"><!--[--><li id="01 导读：Hello~TypeScript" class="menu-item"><a href="/7281039ee2368be55d307bf011c65258/" class="navbar-item"><!----><span class="text">01 导读：Hello~TypeScript</span></a></li><li id="02 TypeScript 应该怎么学" class="menu-item"><a href="/1601340cfd219c2b531af423fb6f80fa/" class="navbar-item"><!----><span class="text">02 TypeScript 应该怎么学</span></a></li><li id="03 VSCode 揭秘和搭建开发环境" class="menu-item"><a href="/ae30075b0044c2f005920493247cd885/" class="navbar-item"><!----><span class="text">03 VSCode 揭秘和搭建开发环境</span></a></li><li id="04 八个 JS 中你见过的类型" class="menu-item"><a href="/7fb644d8a36143034820ab5ac25e2fb1/" class="navbar-item"><!----><span class="text">04 八个 JS 中你见过的类型</span></a></li><li id="05 TS 中补充的六个类型" class="menu-item"><a href="/51924b2f77b29bdddec5f1f7c6bf5d9c/" class="navbar-item"><!----><span class="text">05 TS 中补充的六个类型</span></a></li><li id="06 Symbol-ES6 新基础类型" class="menu-item"><a href="/354f7127cff11de995f0ecbebee8b26b/" class="navbar-item"><!----><span class="text">06 Symbol-ES6 新基础类型</span></a></li><li id="07 深入学习枚举" class="menu-item"><a href="/6ad83d2eb1fa6afb5bede2a5c5bdfaee/" class="navbar-item"><!----><span class="text">07 深入学习枚举</span></a></li><li id="08 使用类型断言达到预期" class="menu-item"><a href="/babd7cdbc00e35e948b88a838e54fa26/" class="navbar-item"><!----><span class="text">08 使用类型断言达到预期</span></a></li><li id="09 使用接口定义几乎任意结构" class="menu-item"><a href="/9f9a1c2317d47e1d7249cb0578a147f6/" class="navbar-item"><!----><span class="text">09 使用接口定义几乎任意结构</span></a></li><li id="10 接口的高阶用法" class="menu-item"><a href="/a422ac39330cb30f14e70811834d39ef/" class="navbar-item"><!----><span class="text">10 接口的高阶用法</span></a></li><li id="11 为函数和函数参数定义类型" class="menu-item"><a href="/768f1c09a2d95e9e9ef73395ba562b98/" class="navbar-item"><!----><span class="text">11 为函数和函数参数定义类型</span></a></li><li id="12 使用泛型拯救你的 any" class="menu-item"><a href="/c8e5ebfa7762499ecb57c388a0692433/" class="navbar-item"><!----><span class="text">12 使用泛型拯救你的 any</span></a></li><li id="13 TS 中的类，小心它与 ES 标准的差异" class="menu-item"><a href="/99bdb1b71b8657aa6febf5f3da5c03db/" class="navbar-item"><!----><span class="text">13 TS 中的类，小心它与 ES 标准的差异</span></a></li><li id="14 类型推断，看 TS 有多懂你" class="menu-item"><a href="/f6fa41db0a5a806a5e73b26d9b26339e/" class="navbar-item"><!----><span class="text">14 类型推断，看 TS 有多懂你</span></a></li><li id="15 类型兼容性，开放心态满足灵活的 JS" class="menu-item"><a href="/b461ad282f548d3873cb2c201fe59815/" class="navbar-item"><!----><span class="text">15 类型兼容性，开放心态满足灵活的 JS</span></a></li><li id="16 使用类型保护让 TS 更聪明" class="menu-item"><a href="/be9d836120fa5e2a3e0f873ad27bee7e/" class="navbar-item"><!----><span class="text">16 使用类型保护让 TS 更聪明</span></a></li><li id="17 使用显式赋值断言给 TS 一个你一定会赋值的承诺" class="menu-item"><a href="/918318944f4d76439b59122ee975a6e2/" class="navbar-item"><!----><span class="text">17 使用显式赋值断言给 TS 一个你一定会赋值的承诺</span></a></li><li id="18 类型别名和字面量类型—单调的类型" class="menu-item"><a href="/c65fc02026c6e0bbedc939733c23389b/" class="navbar-item"><!----><span class="text">18 类型别名和字面量类型—单调的类型</span></a></li><li id="19 使用可辨识联合并保证每个 case 都被处理" class="menu-item"><a href="/b2ade9f0b46ff13a6853c36ac0ad72c4/" class="navbar-item"><!----><span class="text">19 使用可辨识联合并保证每个 case 都被处理</span></a></li><li id="20 this 类型" class="menu-item"><a href="/a26e1a82fb377ff8c4987435c2fd1e1c/" class="navbar-item"><!----><span class="text">20 this 类型</span></a></li><li id="21 索引类型：获取索引类型和索引值类型" class="menu-item"><a href="/c90decc792e398e04514d07b08f3a399/" class="navbar-item"><!----><span class="text">21 索引类型：获取索引类型和索引值类型</span></a></li><li id="22 使用映射类型得到新的类型" class="active menu-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/" class="router-link-active router-link-exact-active navbar-item"><!----><span class="text">22 使用映射类型得到新的类型</span></a></li><li id="23 前面跳过的 unkown 类型详解" class="menu-item"><a href="/60c9b386a2b8c850f2a9819f1a5452fa/" class="navbar-item"><!----><span class="text">23 前面跳过的 unkown 类型详解</span></a></li><li id="24 条件类型，它不是三元操作符的写法吗？" class="menu-item"><a href="/f76946b2f859638e4cde211ecddb59a9/" class="navbar-item"><!----><span class="text">24 条件类型，它不是三元操作符的写法吗？</span></a></li><li id="25 入手装饰器，给凡人添加超能力" class="menu-item"><a href="/3d61b0309b63d352d3b39fae56239383/" class="navbar-item"><!----><span class="text">25 入手装饰器，给凡人添加超能力</span></a></li><li id="26 使用模块封装代码" class="menu-item"><a href="/7eab97a57cb7669b70825c218c6b5921/" class="navbar-item"><!----><span class="text">26 使用模块封装代码</span></a></li><li id="27 使用命名空间封装代码" class="menu-item"><a href="/dbee3792c8487ef23ab8ab012c68095e/" class="navbar-item"><!----><span class="text">27 使用命名空间封装代码</span></a></li><li id="28 对声明合并的爱与恨" class="menu-item"><a href="/ba5ddaa734be5fc316eb6ab94efb19a8/" class="navbar-item"><!----><span class="text">28 对声明合并的爱与恨</span></a></li><li id="29 混入，兼顾值和类型的合并操作" class="menu-item"><a href="/7407a8164569b9ee3a9cc8b033260f64/" class="navbar-item"><!----><span class="text">29 混入，兼顾值和类型的合并操作</span></a></li><li id="30 Promise 及其语法糖 async 和 await" class="menu-item"><a href="/2f8b646ce37b1ff9071ead44a4e43837/" class="navbar-item"><!----><span class="text">30 Promise 及其语法糖 async 和 await</span></a></li><li id="31 逐条来看 tsconfig.json 配置" class="menu-item"><a href="/a2f90e489ca7127dc2106b18ec90eda5/" class="navbar-item"><!----><span class="text">31 逐条来看 tsconfig.json 配置</span></a></li><li id="32 书写声明文件之磨刀：识别库类型" class="menu-item"><a href="/f4c4ebaf6f1699fc1f7ec7017ced51f8/" class="navbar-item"><!----><span class="text">32 书写声明文件之磨刀：识别库类型</span></a></li><li id="33 书写声明文件之砍柴：为不同类型库书写声明文件" class="menu-item"><a href="/65d3dd70b1a30407e99f5b15a8db243e/" class="navbar-item"><!----><span class="text">33 书写声明文件之砍柴：为不同类型库书写声明文件</span></a></li><li id="34 结束语" class="menu-item"><a href="/63a2866bd8ea8b76c6a4e35a403be9ff/" class="navbar-item"><!----><span class="text">34 结束语</span></a></li><!--]--></ul></aside><div class="theme-content post-container"><div class="post-wrapper"><i class="iconfont icon-book toc-btn"></i><i class="iconfont icon-menu aside-btn"></i><div class="markdown-body"><h1 class="post-title"><span>22 使用映射类型得到新的类型</span></h1><div class="post-info"><span class="post-info-item"><i class="iconfont icon-avatar" title="作者"></i> 前端程序猿</span><span class="post-info-item"><i class="iconfont icon-datetime" title="日期"></i> 2022-08-12</span><span class="post-info-item"><i class="iconfont icon-categorynormal" title="分类"></i><!--[--><a href="/categories/?category=%E5%A4%A7%E5%89%8D%E7%AB%AF" class="post-type">大前端</a><!--]--></span><span class="post-info-item"><i class="iconfont icon-tag" title="标签"></i><!--[--><a href="/tags/?tag=typescript" class="post-type">typescript</a><!--]--></span></div><div><blockquote><p>知识是一种快乐，而好奇则是知识的萌芽。 ——培根</p></blockquote><p>TS 提供了借助旧类型创建一个新类型的方式，也就是映射类型，它可以用相同的形式去转换旧类型中每个属性。来看个例子：</p><h2 id="_1-基础" tabindex="-1"><a class="header-anchor" href="#_1-基础" aria-hidden="true">#</a> 1 基础</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Info</span> <span class="token punctuation">{</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以使用这个接口实现一个有且仅有一个 age 属性的对象，但如果我们想再创建一个只读版本的同款对象，那我们可能需要再重新定义一个接口，然后让 age 属性 readonly。如果接口就这么简单，你确实可以这么做，但是如果属性多了，而且这个结构以后会变，那就比较麻烦了。这种情况我们可以使用映射类型，下面来看例子：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Info</span> <span class="token punctuation">{</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token comment">// 这里定义了一个ReadonlyType&lt;T&gt;映射类型</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyInfo</span> <span class="token operator">=</span> ReadonlyType<span class="token operator">&lt;</span>Info<span class="token operator">&gt;</span>
<span class="token keyword">let</span> info<span class="token operator">:</span> ReadonlyInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
info<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">28</span> <span class="token comment">// error Cannot assign to &#39;age&#39; because it is a constant or a read-only property</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子展示了如何通过一个普通的接口创建一个每个属性都只读的接口，这个过程有点像定义了一个函数，这个函数会遍历传入对象的每个属性并做处理。同理你也可以创建一个每个属性都是可选属性的接口：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Info</span> <span class="token punctuation">{</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyInfo</span> <span class="token operator">=</span> ReadonlyType<span class="token operator">&lt;</span>Info<span class="token operator">&gt;</span>
<span class="token keyword">let</span> info<span class="token operator">:</span> ReadonlyInfo <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意了，我们在这里用到了一个新的操作符 in，TS 内部使用了 for … in，定义映射类型，这里涉及到三个部分：</p><p>类型变量，也就是上例中的 P，它就像 for…in 循环中定义的变量，用来在每次遍历中绑定当前遍历到的属性名； 属性名联合，也就是上例中 keyof T，它返回对象 T 的属性名联合； 属性的结果类型，也就是 T[P]。</p><p>因为这两个需求较为常用，所以 TS 内置了这两种映射类型，无需定义即可使用，它们分别是 Readonly 和 Partial。还有两个内置的映射类型分别是 Pick 和 Record，它们的实现如下：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">Record<span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>先来使用一下 Pick，官方文档的例子并不完整，我们来看完整的例子</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Info</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
  address<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> info<span class="token operator">:</span> Info <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;lison&#39;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">&#39;beijing&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">pick</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> keys<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里我们定义一个pick函数，用来返回一个对象中指定字段的值组成的对象</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span>
  keys<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
<span class="token keyword">const</span> nameAndAddress <span class="token operator">=</span> <span class="token function">pick</span><span class="token punctuation">(</span>info<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;address&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// { name: &#39;lison&#39;, address: &#39;beijing&#39; }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另外一个就是 Record，它适用于将一个对象中的每一个属性转换为其他值的场景，来看例子：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">mapObject</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  obj<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">f</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">U</span>
<span class="token punctuation">)</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Record<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span>

<span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token string">&#39;hello&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token string">&#39;world&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token string">&#39;bye&#39;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> lengths <span class="token operator">=</span> <span class="token function">mapObject</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// { 0: 5, 1: 5, 2: 3 }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们输入的对象属性值为字符串类型，输出的对象属性值为数值类型。</p><p>讲完这四个内置的映射类型之后，我们需要讲一个概念——同态。两个相同类型的代数结构之间的结构保持映射。</p><p>这四个内置映射类型中，Readonly、Partial 和 Pick 是同态的，而 Record 不是，因为 Record 映射出的对象属性值是新的，和输入的值的属性值不同。</p><h2 id="_2-由映射类型进行推断" tabindex="-1"><a class="header-anchor" href="#_2-由映射类型进行推断" aria-hidden="true">#</a> 2 由映射类型进行推断</h2><p>我们学习了使用映射类型包装一个类型的属性后，也可以进行逆向操作，也就是拆包，先来看我们的包装操作：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Proxy<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里定义一个映射类型，他将一个属性拆分成get/set方法</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span>
  <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">Proxify<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> Proxy<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token comment">// 这里再定义一个映射类型，将一个对象的所有属性值类型都变为Proxy&lt;T&gt;处理之后的类型</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">proxify</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> Proxify<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里定义一个proxify函数，用来将对象中所有属性的属性值改为一个包含get和set方法的对象</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Proxify<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;lison&#39;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> proxyProps <span class="token operator">=</span> <span class="token function">proxify</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proxyProps<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;lison&quot;</span>
proxyProps<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们来看下这个例子，这个例子我们定义了一个函数，这个函数可以把传入的对象的每个属性的值替换为一个包含 get 和 set 两个方法的对象。最后我们获取某个值的时候，比如 name，就使用 proxyProps.name.get()方法获取它的值，使用 proxyProps.name.set()方法修改 name 的值。</p><p>接下来我们来看如何进行拆包：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">unproxify</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>t<span class="token operator">:</span> Proxify<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里我们定义一个拆包函数，其实就是利用每个属性的get方法获取到当前属性值，然后将原本是包含get和set方法的对象改为这个属性值</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token constant">T</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> k <span class="token keyword">in</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 这里通过调用属性值这个对象的get方法获取到属性值，然后赋给这个属性，替换掉这个对象</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">let</span> originalProps <span class="token operator">=</span> <span class="token function">unproxify</span><span class="token punctuation">(</span>proxyProps<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-增加或移除特定修饰符" tabindex="-1"><a class="header-anchor" href="#_3-增加或移除特定修饰符" aria-hidden="true">#</a> 3 增加或移除特定修饰符</h2><p>TS 在 2.8 版本为映射类型增加了增加或移除特定修饰符的能力，使用+和-符号作为前缀来指定增加还是删除修饰符。首先来看我们如何通过映射类型为一个接口的每个属性增加修饰符，我们这里使用+前缀：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Info</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyInfo<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> info<span class="token operator">:</span> ReadonlyInfo<span class="token operator">&lt;</span>Info<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;lison&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
info<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// error</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子中，经过 ReadonlyInfo 创建的接口类型，属性是可选的，所以我们在定义 info 的时候没有写 age 属性也没问题，同时每个属性是只读的，所以我们修改 name 的值的时候报错。我们通过+前缀增加了 readonly 和?修饰符。当然，增加的时候，这个+前缀可以省略，也就是说，上面的写法和 type ReadonlyInfo = { readonly [P in keyof T]?: T[P] }是一样的。我们再来看下怎么删除修饰符：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Info</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">RemoveModifier<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">InfoType</span> <span class="token operator">=</span> RemoveModifier<span class="token operator">&lt;</span>Readonly<span class="token operator">&lt;</span>Partial<span class="token operator">&lt;</span>Info<span class="token operator">&gt;&gt;&gt;</span>
<span class="token keyword">let</span> info1<span class="token operator">:</span> InfoType <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// error missing &quot;age&quot;</span>
  name<span class="token operator">:</span> <span class="token string">&#39;lison&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> info2<span class="token operator">:</span> InfoType <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;lison&#39;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
info2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token comment">// right, can edit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子我们定义了去掉修饰符的映射类型 RemoveModifier，Readonly<code>&lt;Partial&lt;Info&gt;&gt;</code>则是返回一个既属性可选又只读的接口类型，所以 InfoType 类型则表示属性必含而且非只读。</p><p>TS 内置了一个映射类型 <code>Required&lt;T&gt;</code>，使用它可以去掉 T 所有属性的?修饰符。</p><h2 id="_4-keyof-和映射类型在-2-9-的升级" tabindex="-1"><a class="header-anchor" href="#_4-keyof-和映射类型在-2-9-的升级" aria-hidden="true">#</a> 4 keyof 和映射类型在 2.9 的升级</h2><p>TS 在 2.9 版本中，keyof 和映射类型支持用 number 和 symbol 命名的属性，我们先来看 keyof 的例子：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> stringIndex <span class="token operator">=</span> <span class="token string">&#39;a&#39;</span>
<span class="token keyword">const</span> numberIndex <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">const</span> symbolIndex <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> <span class="token class-name">Obj</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>stringIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">[</span>numberIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token punctuation">[</span>symbolIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">symbol</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">keys</span> <span class="token operator">=</span> <span class="token keyword">keyof</span> Obj
<span class="token keyword">let</span> key<span class="token operator">:</span> keys <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// error</span>
<span class="token keyword">let</span> key<span class="token operator">:</span> keys <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// right</span>
<span class="token keyword">let</span> key<span class="token operator">:</span> keys <span class="token operator">=</span> <span class="token string">&#39;b&#39;</span> <span class="token comment">// error</span>
<span class="token keyword">let</span> key<span class="token operator">:</span> keys <span class="token operator">=</span> <span class="token string">&#39;a&#39;</span> <span class="token comment">// right</span>
<span class="token keyword">let</span> key<span class="token operator">:</span> keys <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// error</span>
<span class="token keyword">let</span> key<span class="token operator">:</span> keys <span class="token operator">=</span> symbolIndex <span class="token comment">// right</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再来看个映射类型的例子：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> stringIndex <span class="token operator">=</span> <span class="token string">&#39;a&#39;</span>
<span class="token keyword">const</span> numberIndex <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">const</span> symbolIndex <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> <span class="token class-name">Obj</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>stringIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">[</span>numberIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token punctuation">[</span>symbolIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">symbol</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> obj<span class="token operator">:</span> ReadonlyType<span class="token operator">&lt;</span>Obj<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token string">&#39;aa&#39;</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>symbolIndex<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">&#39;bb&#39;</span> <span class="token comment">// error Cannot assign to &#39;a&#39; because it is a read-only property</span>
obj<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span> <span class="token comment">// error Cannot assign to &#39;1&#39; because it is a read-only property</span>
obj<span class="token punctuation">[</span>symbolIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// error Cannot assign to &#39;[symbolIndex]&#39; because it is a read-only property</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-元组和数组上的映射类型" tabindex="-1"><a class="header-anchor" href="#_5-元组和数组上的映射类型" aria-hidden="true">#</a> 5 元组和数组上的映射类型</h2><p>TS 在 3.1 版本中，在元组和数组上的映射类型会生成新的元组和数组，并不会创建一个新的类型，这个类型上会具有 push、pop 等数组方法和数组属性。来看例子：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">MapToPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">Tuple</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">boolean</span><span class="token punctuation">]</span>
<span class="token keyword">type</span> <span class="token class-name">promiseTuple</span> <span class="token operator">=</span> MapToPromise<span class="token operator">&lt;</span>Tuple<span class="token operator">&gt;</span>
<span class="token keyword">let</span> tuple<span class="token operator">:</span> promiseTuple <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子中定义了一个 MapToPromise 映射类型。它返回一个将传入的类型的所有字段的值转为 Promise，且 Promise 的 resolve 回调函数的参数类型为这个字段类型。我们定义了一个元组 Tuple，元素类型分别为 number、string 和 boolean，使用 MapToPromise 映射类型将这个元组类型传入，并且返回一个 promiseTuple 类型。当我们指定变量 tuple 的类型为 promiseTuple 后，它的三个元素类型都是一个 Promise，且 resolve 的参数类型依次为 number、string 和 boolean。</p><h2 id="本节小结" tabindex="-1"><a class="header-anchor" href="#本节小结" aria-hidden="true">#</a> 本节小结</h2><p>本小节我们学习了映射类型的相关知识，我们学习了映射类型的基础应用，它的定义和使用像极了函数的定义和使用。函数是处理实际的值，而映射类型处理的是类型。我们还通过一个例子学习了由映射类型进行推断，根据映射类型推断出处理前的类型，也就是拆包操作。通过增加或移除特定修饰符&quot;+“和”-“可以实现给字段添加或移除一些 readonly 等修饰符，但用的最多的是”-&quot;。因为如果需要给某个字段加修饰符，&quot;+&quot;是可以省略不写的。最后我们补充了两个 TypeScript 在后面升级中对映射类型的更新。</p><p>下个小节我们将对前面讲 TypeScript 中补充的六个类型中跳过的 unknown 类型进行详细补充学习</p></div></div></div><div class="card-box card-wrapper post-tocs"><header><h3 class="title"><i class="iconfont icon-categorynormal"></i><span> 目录 </span></h3></header><nav class="vuepress-toc"><ul class="vuepress-toc-list"><li class="vuepress-toc-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/#_1-基础" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="1 基础">1 基础</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/#_2-由映射类型进行推断" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="2 由映射类型进行推断">2 由映射类型进行推断</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/#_3-增加或移除特定修饰符" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="3 增加或移除特定修饰符">3 增加或移除特定修饰符</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/#_4-keyof-和映射类型在-2-9-的升级" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="4 keyof 和映射类型在 2.9 的升级">4 keyof 和映射类型在 2.9 的升级</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/#_5-元组和数组上的映射类型" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="5 元组和数组上的映射类型">5 元组和数组上的映射类型</a><!--[--><!--]--></li><li class="vuepress-toc-item"><a aria-current="page" href="/ea4b4b6a32f3be5f0ccbc30825773e2f/#本节小结" class="router-link-active router-link-exact-active vuepress-toc-link" arialabel="本节小结">本节小结</a><!--[--><!--]--></li></ul></nav></div></div></main><footer class="theme-footer theme-common-footer"><div class="copyright"><a class="beian" href="https://beian.miit.gov.cn/#/Integrated/index">Apache-2.0</a><span class="delimiter">|</span><span class="info">Copyright © 2018-2022 lizhi1026.top</span></div></footer><div style="display:none;" class="back-to-top"><i class="iconfont icon-back-to-top"></i></div><!--]--><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.56da2130.js" defer></script><script src="/assets/js/4666.93202135.js" defer></script><script src="/assets/js/app.942499dd.js" defer></script>
  </body>
</html>
